repositories {
  def found = false
  def parentDir = rootProject.projectDir
  def expoAndroidName = 'Expo (Node Modules)'

  1.upto(4, {
    if (found) return true
    parentDir = parentDir.parentFile
    def expoAndroid = new File(
      parentDir,
      'node_modules/expo-core/android'
    )

    if (expoAndroid.exists()) {
      maven {
        url expoAndroid.toString()
        name expoAndroidName
      }

      println "${project.name}: using Expo sources from ${expoAndroid.toString()}"
      found = true
    }
  })

  if (!found) {
    throw new GradleException(
      "${project.name}: unable to locate Expo Android sources, " +
        "ensure you have you installed Expo as a dependency and try again."
    )
  }
}

dependencies {
  //noinspection GradleDynamicVersion
  compileOnly "expo.core:+"
}
